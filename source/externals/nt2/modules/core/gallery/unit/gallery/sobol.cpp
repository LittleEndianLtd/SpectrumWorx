//==============================================================================
//         Copyright 2003 - 2012   LASMEA UMR 6602 CNRS/Univ. Clermont II
//         Copyright 2009 - 2012   LRI    UMR 8623 CNRS/Univ Paris Sud XI
//
//          Distributed under the Boost Software License, Version 1.0.
//                 See accompanying file LICENSE.txt or copy at
//                     http://www.boost.org/LICENSE_1_0.txt
//==============================================================================
#define NT2_UNIT_MODULE "nt2 gallery toolbox - sobol function"

#include <nt2/table.hpp>
#include <nt2/include/functions/sobol.hpp>
#include <nt2/include/functions/transpose.hpp>
#include <nt2/include/functions/cons.hpp>
#include <nt2/sdk/unit/tests.hpp>
#include <nt2/sdk/unit/module.hpp>

NT2_TEST_CASE_TPL ( soboldf, (float))
{
  typedef typename nt2::meta::as_integer<T, unsigned>::type  uint_type;
  nt2::table<uint_type> s3c = nt2::sobol(3, nt2::meta::as_<uint_type>());
  nt2::table<uint_type> s3c1= nt2::sobol<uint_type>(3);
  nt2::table<uint_type> s3
    = nt2::trans(nt2::cons<uint_type>(nt2::of_size(23, 3),
                           4194304,6291456,5242880,7864320,4456448,6684672,5570560,8355840,4210688,6316032,5263360,7895040,4473856,6710784,5592320,8388480,4194368,6291552,5242960,7864440,4456516,6684774,5570645,
                           4194304,2097152,7340032,5767168,3407872,7995392,4390912,2588672,7618560,5906432,3371008,8378368,4224000,2120192,7353088,5799808,3424320,8003616,4419696,2611288,7631924,5921402,3355459,
                           4194304,6291456,7340032,2621440,1835008,5636096,3211264,4816896,7192576,8298496,2977792,2021376,6030336,3540480,4261632,6390400,7455168,2663776,1864464,5725336,3261148,4760042,7108055
                          ));
  NT2_TEST_EQUAL(s3, s3c);
  NT2_TEST_EQUAL(s3, s3c1);
}
NT2_TEST_CASE_TPL ( soboldd, (double))
{
  typedef typename nt2::meta::as_integer<T, unsigned>::type  uint_type;
  nt2::table<uint_type> s3c = nt2::sobol(3, nt2::meta::as_<uint_type>());
  nt2::table<uint_type> s3c1= nt2::sobol<uint_type>(3);
  nt2::table<uint_type> s3
    = nt2::trans(nt2::cons<uint_type>(nt2::of_size(52, 3),
                           2251799813685248,3377699720527872,2814749767106560,4222124650659840,2392537302040576,3588805953060864,2990671627550720,4486007441326080,2260595906707456,3390893860061184,2825744883384320,4238617325076480,2401883150876672,3602824726315008,3002353938595840,4503530907893760,2251834173423616,3377751260135424,2814792716779520,4222189075169280,2392573809262592,3588860713893888,2990717261578240,4486075892367360,2260630400663552,3390945600995328,2825788000829440,4238682001244160,2401919800705024,3602879701057536,3002399750881280,4503599626321920,2251799814209536,3377699721314304,2814749767761920,4222124651642880,2392537302597632,3588805953896448,2990671628247040,4486007442370560,2260595907233792,3390893860850688,2825744884042240,4238617326063360,2401883151435904,3602824727153856,3002353939294880,4503530908942320,2251834173947912,3377751260921868,2814792717434890,4222189076152335,
                           2251799813685248,1125899906842624,3940649673949184,3096224743817216,1829587348619264,4292493394837504,2357352929951744,1389782697508864,4090183255326720,3170991534505984,1809796139319296,4498102069231616,2267742732288000,1138269412655104,3947659060576256,3113748210384896,1838417801379840,4296908621217792,2372806222282752,1401924570054656,4097357998194688,3179028492058624,1801448333508608,4503552114294784,2251827865190400,1125965472202752,3940685879181312,3096246134767616,1829649868914688,4292541901963264,2357380417323008,1389851415937024,4090217615589376,3171008714637312,1809856269778944,4498149314592768,2267770650001408,1138334911905792,3947695031476224,3113769417109504,1838411494098944,4296957007447040,2372782298394112,1401898717412096,4097392601730688,3179011501198144,1801439851447904,4503599627046896,2251799814637576,1125899907580932,3940649674370574,3096224744864523,
                           2251799813685248,3377699720527872,3940649673949184,1407374883553280,985162418487296,3025855999639552,1724034232352768,2586051348529152,3861484836749312,4455221115748352,1598689906786304,1085217976614912,3237511987986432,1900780726517760,2287946258448384,3430819876044800,4002462843273216,1430103850483712,1000976488071168,3073766359826432,1750815500926976,2555528089698304,3816107970396160,4480980987412480,1609685157281792,1077521596547072,3287540001931264,1929642990632960,2252349628219392,3378524534603776,3941611849383936,1407718635077632,985403166818304,3026594999566336,1724455234437120,2586682773405696,3862427775041536,4456308929511424,1599080348311552,1085483126902784,3237202854688768,1900694979521536,2287405320004096,3431107905950464,4003165166394240,1430452880817472,1000946082429664,3073400060472752,1750663029587976,2556003757326348,3815726255177742,4481141243379717
                          ));
  NT2_TEST_EQUAL(s3, s3c);
  NT2_TEST_EQUAL(s3, s3c1);
}
